<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Asciistrator - ASCII Vector Graphics Engine & Editor">
    <meta name="author" content="Asciistrator">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Asciistrator - ASCII Vector Graphics Editor</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/ui.css">
</head>
<body data-theme="dark">
    <div id="app">
        <!-- Menu Bar -->
        <header id="menu-bar" class="menu-bar">
            <!-- Mobile Menu Toggle -->
            <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
            <div class="menu-left">
                <span class="app-logo">‚óà Asciistrator</span>
                <nav class="menu-items">
                    <button class="menu-item" data-menu="file">File</button>
                    <button class="menu-item" data-menu="edit">Edit</button>
                    <button class="menu-item" data-menu="view">View</button>
                    <button class="menu-item" data-menu="object">Object</button>
                    <button class="menu-item" data-menu="charts">Charts</button>
                    <button class="menu-item" data-menu="flow">Flow</button>
                    <button class="menu-item" data-menu="window">Window</button>
                    <button class="menu-item" data-menu="help">Help</button>
                </nav>
            </div>
            <div class="menu-right">
                <button class="icon-btn" title="Undo" id="btn-undo">‚Ü©</button>
                <button class="icon-btn" title="Redo" id="btn-redo">‚Ü™</button>
                <span class="separator hide-mobile">|</span>
                <button class="icon-btn" title="Zoom Out" id="btn-zoom-out">‚àí</button>
                <span id="zoom-level" class="zoom-level">100%</span>
                <button class="icon-btn" title="Zoom In" id="btn-zoom-in">+</button>
                <span class="separator hide-mobile">|</span>
                <select id="theme-select" class="theme-select hide-mobile">
                    <option value="dark">Dark</option>
                    <option value="light">Light</option>
                    <option value="midnight">Midnight</option>
                </select>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="main-content">
            <!-- Left Toolbar -->
            <aside id="toolbar" class="toolbar">
                <div class="tool-group">
                    <button class="tool-btn active" data-tool="select" title="Select (V)">
                        <span class="tool-icon">‚äπ</span>
                    </button>
                    <button class="tool-btn" data-tool="direct-select" title="Direct Select (A)">
                        <span class="tool-icon">‚ä∏</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="pen" title="Pen Tool (P)">
                        <span class="tool-icon">‚úé</span>
                    </button>
                    <button class="tool-btn" data-tool="pencil" title="Pencil (N)">
                        <span class="tool-icon">‚úè</span>
                    </button>
                    <button class="tool-btn" data-tool="brush" title="Brush (B)">
                        <span class="tool-icon">‚öü</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="rectangle" title="Rectangle (R)">
                        <span class="tool-icon">‚ñ¢</span>
                    </button>
                    <button class="tool-btn" data-tool="ellipse" title="Ellipse (O)">
                        <span class="tool-icon">‚óã</span>
                    </button>
                    <button class="tool-btn" data-tool="frame" title="Frame (F)">
                        <span class="tool-icon">‚¨ö</span>
                    </button>
                    <button class="tool-btn" data-tool="polygon" title="Polygon">
                        <span class="tool-icon">‚¨°</span>
                    </button>
                    <button class="tool-btn" data-tool="star" title="Star">
                        <span class="tool-icon">‚òÜ</span>
                    </button>
                    <button class="tool-btn" data-tool="line" title="Line (\\)">
                        <span class="tool-icon">‚ï±</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="text" title="Text (T)">
                        <span class="tool-icon">T</span>
                    </button>
                    <button class="tool-btn" data-tool="ascii-text" title="ASCII Text">
                        <span class="tool-icon">‚í∂</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="box-draw" title="Box Draw">
                        <span class="tool-icon">‚îå‚îê</span>
                    </button>
                    <button class="tool-btn" data-tool="table" title="Table">
                        <span class="tool-icon">‚ñ¶</span>
                    </button>
                    <button class="tool-btn" data-tool="tree" title="Tree">
                        <span class="tool-icon">‚îú</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="flowchart" title="Flowchart">
                        <span class="tool-icon">‚óá</span>
                    </button>
                    <button class="tool-btn" data-tool="connector" title="Connector">
                        <span class="tool-icon">‚Üí</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="chart" title="Chart">
                        <span class="tool-icon">‚ñä</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button class="tool-btn" data-tool="eraser" title="Eraser (E)">
                        <span class="tool-icon">‚ó´</span>
                    </button>
                    <button class="tool-btn" data-tool="fill" title="Fill">
                        <span class="tool-icon">‚ñß</span>
                    </button>
                </div>
                <div class="tool-group tool-colors">
                    <div class="color-preview">
                        <div class="stroke-color" id="stroke-color" title="Stroke Color"></div>
                        <div class="fill-color" id="fill-color" title="Fill Color"></div>
                    </div>
                    <button class="tool-btn small" id="swap-colors" title="Swap Colors (X)">
                        <span class="tool-icon">‚áÑ</span>
                    </button>
                </div>
            </aside>
            
            <!-- Mobile Toolbar Toggle -->
            <button id="mobile-toolbar-toggle" class="mobile-toolbar-toggle" aria-label="Toggle toolbar">üîß</button>

            <!-- Canvas Area -->
            <section id="canvas-container" class="canvas-container">
                <!-- Rulers -->
                <div id="ruler-corner" class="ruler-corner"></div>
                <div id="ruler-horizontal" class="ruler ruler-horizontal"></div>
                <div id="ruler-vertical" class="ruler ruler-vertical"></div>
                
                <!-- Canvas Viewport -->
                <div id="viewport" class="viewport">
                    <div id="canvas-wrapper" class="canvas-wrapper">
                        <pre id="ascii-canvas" class="ascii-canvas"></pre>
                        <!-- Selection overlay -->
                        <svg id="overlay" class="overlay"></svg>
                    </div>
                </div>

                <!-- Scrollbars -->
                <div id="scrollbar-horizontal" class="scrollbar scrollbar-horizontal">
                    <div class="scrollbar-thumb"></div>
                </div>
                <div id="scrollbar-vertical" class="scrollbar scrollbar-vertical">
                    <div class="scrollbar-thumb"></div>
                </div>
            </section>

            <!-- Right Panel -->
            <aside id="panel-right" class="panel panel-right">
                <!-- Panel Tabs -->
                <div class="panel-tabs">
                    <button class="panel-tab active" data-panel="layers">Layers</button>
                    <button class="panel-tab" data-panel="properties">Props</button>
                    <button class="panel-tab" data-panel="components">Comps</button>
                    <button class="panel-tab" data-panel="chars">Chars</button>
                </div>

                <!-- Layers Panel -->
                <div id="panel-layers" class="panel-content active">
                    <div class="panel-header">
                        <span>Layers</span>
                        <div class="panel-actions">
                            <button class="icon-btn small" title="New Layer" id="btn-new-layer">+</button>
                            <button class="icon-btn small" title="Delete Layer" id="btn-delete-layer">‚àí</button>
                        </div>
                    </div>
                    <div id="layer-list" class="layer-list">
                        <div class="layer-item active" data-layer="0">
                            <button class="layer-visibility" title="Toggle Visibility">üëÅ</button>
                            <button class="layer-lock" title="Toggle Lock">üîì</button>
                            <span class="layer-name">Layer 1</span>
                        </div>
                    </div>
                </div>

                <!-- Properties Panel -->
                <div id="panel-properties" class="panel-content">
                    <div class="panel-header">
                        <span>Properties</span>
                    </div>
                    <div class="properties-content">
                        <div class="property-group" id="prop-text-group" style="display:none;">
                            <label>Text</label>
                            <div class="property-row">
                                <input type="text" id="prop-text" placeholder="Enter text...">
                            </div>
                        </div>
                        <div class="property-group">
                            <label>Position</label>
                            <div class="property-row">
                                <label>X:</label>
                                <input type="number" id="prop-x" value="0">
                                <label>Y:</label>
                                <input type="number" id="prop-y" value="0">
                            </div>
                        </div>
                        <div class="property-group">
                            <label>Size</label>
                            <div class="property-row">
                                <label>W:</label>
                                <input type="number" id="prop-width" value="0">
                                <label>H:</label>
                                <input type="number" id="prop-height" value="0">
                            </div>
                        </div>
                        <div class="property-group">
                            <label>Colors</label>
                            <div class="property-row">
                                <label>Stroke:</label>
                                <input type="color" id="prop-stroke-color" value="#ffffff">
                            </div>
                            <div class="property-row">
                                <label>Fill:</label>
                                <input type="color" id="prop-fill-color" value="#ffffff">
                            </div>
                        </div>
                        <div class="property-group">
                            <label>Style</label>
                            <div class="property-row">
                                <label>Border:</label>
                                <select id="prop-border-style">
                                    <option value="single">Single ‚îÄ</option>
                                    <option value="double">Double ‚ïê</option>
                                    <option value="rounded">Rounded ‚ï≠</option>
                                    <option value="heavy">Heavy ‚îÅ</option>
                                    <option value="dashed">Dashed ‚îÑ</option>
                                    <option value="ascii">ASCII +-|</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Fill:</label>
                                <select id="prop-fill-char">
                                    <option value="">None</option>
                                    <option value=" ">Space</option>
                                    <option value=".">Dot .</option>
                                    <option value="‚ñë">Light ‚ñë</option>
                                    <option value="‚ñí">Medium ‚ñí</option>
                                    <option value="‚ñì">Dark ‚ñì</option>
                                    <option value="‚ñà">Full ‚ñà</option>
                                </select>
                            </div>
                        </div>
                        <!-- Constraints Section -->
                        <div class="property-group" id="prop-constraints-group">
                            <label>üìê Constraints</label>
                            <div class="property-row">
                                <label>Horizontal:</label>
                                <select id="prop-constraint-h">
                                    <option value="left">‚¨Ö Left</option>
                                    <option value="right">‚û° Right</option>
                                    <option value="leftRight">‚Üî Left & Right</option>
                                    <option value="center">‚¨å Center</option>
                                    <option value="scale">‚§¢ Scale</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Vertical:</label>
                                <select id="prop-constraint-v">
                                    <option value="top">‚¨Ü Top</option>
                                    <option value="bottom">‚¨á Bottom</option>
                                    <option value="topBottom">‚Üï Top & Bottom</option>
                                    <option value="center">‚¨ç Center</option>
                                    <option value="scale">‚§° Scale</option>
                                </select>
                            </div>
                            <button class="btn btn-small" id="btn-edit-constraints" style="margin-top: 8px; width: 100%;">Edit Constraints...</button>
                        </div>
                        <!-- Auto Layout Section -->
                        <div class="property-group" id="prop-auto-layout-group" style="display:none;">
                            <label>üì¶ Auto Layout</label>
                            <div class="property-row">
                                <label>Enabled:</label>
                                <input type="checkbox" id="prop-auto-layout-enabled">
                            </div>
                            <div class="property-row">
                                <label>Direction:</label>
                                <select id="prop-auto-layout-direction">
                                    <option value="vertical">‚Üì Vertical</option>
                                    <option value="horizontal">‚Üí Horizontal</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Spacing:</label>
                                <input type="number" id="prop-auto-layout-spacing" value="1" min="0" style="width: 60px;">
                            </div>
                            <div class="property-row">
                                <label>Padding:</label>
                                <input type="number" id="prop-auto-layout-padding" value="1" min="0" style="width: 60px;" title="All sides">
                            </div>
                            <div class="property-row">
                                <label>Alignment:</label>
                                <select id="prop-auto-layout-alignment">
                                    <option value="start">Start</option>
                                    <option value="center">Center</option>
                                    <option value="end">End</option>
                                    <option value="stretch">Stretch</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Distribution:</label>
                                <select id="prop-auto-layout-distribution">
                                    <option value="packed">Packed</option>
                                    <option value="spaceBetween">Space Between</option>
                                    <option value="spaceAround">Space Around</option>
                                    <option value="spaceEvenly">Space Evenly</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Wrap:</label>
                                <input type="checkbox" id="prop-auto-layout-wrap">
                            </div>
                        </div>
                        <!-- Appearance Section (Figma-style) -->
                        <div class="property-group" id="prop-appearance-group">
                            <label>üé® Appearance</label>
                            <div class="property-row">
                                <label>Opacity:</label>
                                <input type="range" id="prop-opacity" min="0" max="100" value="100" style="width: 80px;">
                                <span id="prop-opacity-value">100%</span>
                            </div>
                            <div class="property-row">
                                <label>Blend:</label>
                                <select id="prop-blend-mode">
                                    <option value="normal">Normal</option>
                                    <option value="passThrough">Pass Through</option>
                                    <option value="multiply">Multiply</option>
                                    <option value="screen">Screen</option>
                                    <option value="overlay">Overlay</option>
                                    <option value="darken">Darken</option>
                                    <option value="lighten">Lighten</option>
                                    <option value="colorDodge">Color Dodge</option>
                                    <option value="colorBurn">Color Burn</option>
                                    <option value="hardLight">Hard Light</option>
                                    <option value="softLight">Soft Light</option>
                                    <option value="difference">Difference</option>
                                    <option value="exclusion">Exclusion</option>
                                </select>
                            </div>
                        </div>
                        <!-- Stroke Section (Figma-style) -->
                        <div class="property-group" id="prop-stroke-group">
                            <label>‚úèÔ∏è Stroke</label>
                            <div class="property-row">
                                <label>Weight:</label>
                                <input type="number" id="prop-stroke-weight" value="1" min="0" max="10" style="width: 50px;">
                            </div>
                            <div class="property-row">
                                <label>Align:</label>
                                <select id="prop-stroke-align">
                                    <option value="center">Center</option>
                                    <option value="inside">Inside</option>
                                    <option value="outside">Outside</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Cap:</label>
                                <select id="prop-stroke-cap">
                                    <option value="none">None</option>
                                    <option value="round">Round</option>
                                    <option value="square">Square</option>
                                    <option value="arrow">Arrow ‚Üí</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Join:</label>
                                <select id="prop-stroke-join">
                                    <option value="miter">Miter</option>
                                    <option value="round">Round</option>
                                    <option value="bevel">Bevel</option>
                                </select>
                            </div>
                            <div class="property-row">
                                <label>Dash:</label>
                                <input type="text" id="prop-stroke-dash" placeholder="e.g. 4,2" style="width: 70px;" title="Dash pattern (e.g. 4,2 for dashed)">
                            </div>
                        </div>
                        <!-- Corner Radius Section (Figma-style) -->
                        <div class="property-group" id="prop-corner-group" style="display:none;">
                            <label>‚¨õ Corner Radius</label>
                            <div class="property-row">
                                <label>All:</label>
                                <input type="number" id="prop-corner-all" value="0" min="0" style="width: 50px;">
                                <label style="margin-left: 8px;">
                                    <input type="checkbox" id="prop-corner-independent"> Independent
                                </label>
                            </div>
                            <div id="prop-corner-individual" style="display:none;">
                                <div class="property-row">
                                    <label>TL:</label>
                                    <input type="number" id="prop-corner-tl" value="0" min="0" style="width: 40px;">
                                    <label>TR:</label>
                                    <input type="number" id="prop-corner-tr" value="0" min="0" style="width: 40px;">
                                </div>
                                <div class="property-row">
                                    <label>BL:</label>
                                    <input type="number" id="prop-corner-bl" value="0" min="0" style="width: 40px;">
                                    <label>BR:</label>
                                    <input type="number" id="prop-corner-br" value="0" min="0" style="width: 40px;">
                                </div>
                            </div>
                        </div>
                        <!-- Effects Section (Figma-style) -->
                        <div class="property-group" id="prop-effects-group">
                            <label>‚ú® Effects</label>
                            <div id="prop-effects-list"></div>
                            <button class="btn btn-small" id="btn-add-effect" style="margin-top: 4px; width: 100%;">+ Add Effect</button>
                        </div>
                        <!-- UI Component Properties -->
                        <div class="property-group" id="prop-ui-component-group" style="display:none;">
                            <label>UI Component: <span id="prop-ui-type"></span></label>
                            <div id="prop-ui-properties"></div>
                        </div>
                    </div>
                </div>

                <!-- Components Panel -->
                <div id="panel-components" class="panel-content">
                    <div class="panel-header">
                        <span>Components</span>
                        <div class="panel-actions">
                            <button class="icon-btn small" title="Create Component from Selection" id="btn-create-component">+</button>
                            <button class="icon-btn small" title="Import Library" id="btn-import-library">üì•</button>
                            <button class="icon-btn small" title="Export Library" id="btn-export-library">üì§</button>
                            <button class="icon-btn small" title="Export to Avalonia XAML" id="btn-export-avalonia">‚ö°</button>
                            <button class="icon-btn small" title="New Library" id="btn-new-library">üìÅ</button>
                        </div>
                    </div>
                    <div class="components-toolbar">
                        <input type="text" id="component-search" class="component-search" placeholder="Search components...">
                        <select id="component-export-format" class="component-export-select" title="Export Format">
                            <option value="">Export as...</option>
                            <option value="avalonia-xaml">Avalonia XAML</option>
                            <option value="avalonia-window">Avalonia Window</option>
                            <option value="avalonia-usercontrol">Avalonia UserControl</option>
                            <option value="react">React Component</option>
                            <option value="vue">Vue Component</option>
                            <option value="html">HTML</option>
                        </select>
                    </div>
                    <div id="component-libraries" class="component-libraries">
                        <!-- Libraries and components will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Characters Panel -->
                <div id="panel-chars" class="panel-content">
                    <div class="panel-header">
                        <span>Characters</span>
                    </div>
                    <div class="chars-content">
                        <div class="char-category">
                            <label>Box Drawing</label>
                            <div class="char-grid" id="chars-box"></div>
                        </div>
                        <div class="char-category">
                            <label>Blocks</label>
                            <div class="char-grid" id="chars-blocks"></div>
                        </div>
                        <div class="char-category">
                            <label>Arrows</label>
                            <div class="char-grid" id="chars-arrows"></div>
                        </div>
                        <div class="char-category">
                            <label>Shapes</label>
                            <div class="char-grid" id="chars-shapes"></div>
                        </div>
                        <div class="char-category">
                            <label>Math</label>
                            <div class="char-grid" id="chars-math"></div>
                        </div>
                        <div class="char-category">
                            <label>Misc Symbols</label>
                            <div class="char-grid" id="chars-misc"></div>
                        </div>
                        <div class="char-category">
                            <label>ASCII (Printable)</label>
                            <div class="char-grid" id="chars-ascii"></div>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Status Bar -->
        <footer id="status-bar" class="status-bar">
            <div class="status-left">
                <span id="status-message">Ready</span>
                <span class="separator hide-mobile">|</span>
                <span id="status-tool">Select</span>
            </div>
            <div class="status-right">
                <span id="status-objects" class="hide-mobile-sm">Objects: 0</span>
                <span class="separator hide-mobile-sm">|</span>
                <span id="status-layers" class="hide-mobile-sm">Layers: 1</span>
                <span class="separator hide-mobile-sm">|</span>
                <span id="status-zoom">Zoom: 100%</span>
                <span class="separator hide-mobile">|</span>
                <span id="status-grid" class="hide-mobile">Grid: 1√ó1</span>
                <span class="separator hide-mobile">|</span>
                <span id="status-snap" class="status-snap clickable hide-mobile" title="Toggle snapping (Ctrl+;)">‚äô Snap</span>
                <span class="separator hide-mobile">|</span>
                <span id="status-position">Pos: (0, 0)</span>
                <span class="separator hide-mobile-sm">|</span>
                <span id="status-canvas-size" class="hide-mobile-sm">Canvas: 120√ó40</span>
            </div>
        </footer>
        
        <!-- Mobile Panel Toggle -->
        <button id="mobile-panel-toggle" class="mobile-panel-toggle" aria-label="Toggle panel">‚óß</button>
    </div>

    <!-- Dialogs Container -->
    <div id="dialogs" class="dialogs-container"></div>

    <!-- Context Menu Container -->
    <div id="context-menu" class="context-menu hidden"></div>

    <!-- Scripts -->
    <script type="module" src="scripts/app.js"></script>
</body>
</html>
